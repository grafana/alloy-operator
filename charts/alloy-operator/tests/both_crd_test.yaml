# yamllint disable rule:document-start rule:line-length rule:trailing-spaces
suite: Test both CRDs
templates:
  - charts/alloy-crd/templates/crds/collectors.grafana.com_alloy.yaml
  - charts/podlogs-crd/templates/crds/monitoring.grafana.com_podlogs.yaml
tests:
  - it: can deploy both CRDs
    set:
      crds:
        deployAlloyCRD: true
        deployPodLogsCRD: true
    asserts:
      - template: charts/alloy-crd/templates/crds/collectors.grafana.com_alloy.yaml
        containsDocument:
          apiVersion: apiextensions.k8s.io/v1
          kind: CustomResourceDefinition
          name: alloys.collectors.grafana.com
      - template: charts/pod-logs-crd/templates/crds/monitoring.grafana.com_podlogs.yaml
        containsDocument:
          apiVersion: apiextensions.k8s.io/v1
          kind: CustomResourceDefinition
          name: podlogs.monitoring.grafana.com
